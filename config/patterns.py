"""
Centralized patterns and signatures for Rankle

This module contains shared data structures used across multiple modules
to avoid duplication and ensure consistency.
"""

# Common subdomain prefixes (used by subdomains.py and origin.py)
COMMON_SUBDOMAINS: list[str] = [
    # Web/Application
    "www",
    "www2",
    "www3",
    "web",
    "app",
    "mobile",
    "m",
    # API/Backend
    "api",
    "api-internal",
    "backend",
    "gateway",
    "graphql",
    "rest",
    # Development/Staging
    "dev",
    "development",
    "staging",
    "stage",
    "test",
    "testing",
    "qa",
    "uat",
    "sandbox",
    "demo",
    "beta",
    "alpha",
    "preprod",
    "pre-prod",
    "prod",
    "production",
    # Legacy/Versioning
    "old",
    "new",
    "legacy",
    "v1",
    "v2",
    "v3",
    # Infrastructure
    "origin",
    "origin-www",
    "direct",
    "direct-www",
    "real",
    "server",
    "lb",
    "load",
    "edge",
    "proxy",
    "cdn",
    "static",
    "assets",
    "img",
    "images",
    "media",
    "files",
    "download",
    # Mail
    "mail",
    "email",
    "smtp",
    "webmail",
    "mx",
    # DNS
    "ns1",
    "ns2",
    "ns3",
    "dns",
    "dns1",
    "dns2",
    # Admin/Management
    "admin",
    "administrator",
    "panel",
    "dashboard",
    "portal",
    "cpanel",
    "whm",
    "plesk",
    "webmin",
    "cms",
    "wp",
    "wordpress",
    # Security/Auth
    "login",
    "sso",
    "auth",
    "oauth",
    "id",
    "accounts",
    "account",
    "secure",
    "vpn",
    "remote",
    # Support
    "support",
    "help",
    "docs",
    "documentation",
    "wiki",
    "kb",
    "faq",
    "status",
    "blog",
    "news",
    # Internal
    "internal",
    "intranet",
    "extranet",
    "corp",
    "corporate",
    "office",
    # FTP/Storage
    "ftp",
    "sftp",
    "ssh",
    "backup",
    "bak",
    "storage",
    # Shop/Commerce
    "shop",
    "store",
    "cart",
    "checkout",
    "pay",
    "payment",
]

# Subdomains that often bypass CDN (subset focused on origin discovery)
ORIGIN_BYPASS_SUBDOMAINS: list[str] = [
    "origin",
    "origin-www",
    "direct",
    "direct-www",
    "real",
    "backend",
    "server",
    "internal",
    "api",
    "api-internal",
    "staging",
    "stage",
    "dev",
    "development",
    "test",
    "preprod",
    "uat",
    "qa",
    "sandbox",
    "old",
    "legacy",
    "backup",
    "mail",
    "smtp",
    "webmail",
    "cpanel",
    "whm",
    "ftp",
    "sftp",
    "vpn",
    "remote",
    "panel",
    "dashboard",
    "portal",
    "intranet",
    "ns1",
    "ns2",
]

# Cloud provider IP ranges and patterns (used by geolocation.py and origin.py)
CLOUD_PROVIDERS: dict[str, dict[str, list[str]]] = {
    "AWS": {
        "ip_ranges": [
            "3.0.0.0/8",
            "13.0.0.0/8",
            "15.0.0.0/8",
            "18.0.0.0/8",
            "23.20.0.0/14",
            "34.192.0.0/10",
            "35.160.0.0/11",
            "44.192.0.0/10",
            "50.16.0.0/14",
            "52.0.0.0/8",
            "54.0.0.0/8",
            "63.32.0.0/14",
            "64.252.0.0/14",
            "65.0.0.0/10",
            "67.202.0.0/16",
            "72.21.192.0/19",
            "75.101.128.0/17",
            "79.125.0.0/16",
            "99.77.128.0/17",
            "99.150.0.0/15",
            "100.20.0.0/14",
            "107.20.0.0/14",
            "174.129.0.0/16",
            "176.32.96.0/19",
            "184.72.0.0/13",
            "204.236.128.0/17",
        ],
        "rdns_patterns": [
            r"\.amazonaws\.com$",
            r"\.aws\.amazon\.com$",
            r"ec2.*\.compute",
        ],
    },
    "Google Cloud": {
        "ip_ranges": [
            "8.34.208.0/20",
            "8.35.192.0/20",
            "23.236.48.0/20",
            "23.251.128.0/19",
            "34.64.0.0/10",
            "35.184.0.0/13",
            "35.192.0.0/11",
            "35.224.0.0/12",
            "35.240.0.0/13",
            "104.154.0.0/15",
            "104.196.0.0/14",
            "107.167.160.0/19",
            "107.178.192.0/18",
            "108.59.80.0/20",
            "108.170.192.0/18",
            "130.211.0.0/16",
            "142.250.0.0/15",
            "146.148.0.0/17",
            "162.216.148.0/22",
            "162.222.176.0/21",
            "173.194.0.0/16",
            "173.255.112.0/20",
            "199.36.154.0/23",
            "199.192.112.0/22",
            "199.223.232.0/21",
            "208.68.108.0/22",
            "209.85.128.0/17",
        ],
        "rdns_patterns": [
            r"\.googleusercontent\.com$",
            r"\.google\.com$",
            r"\.1e100\.net$",
        ],
    },
    "Azure": {
        "ip_ranges": [
            "13.64.0.0/11",
            "13.96.0.0/13",
            "13.104.0.0/14",
            "20.0.0.0/8",
            "23.96.0.0/13",
            "40.64.0.0/10",
            "51.104.0.0/14",
            "51.124.0.0/14",
            "51.136.0.0/15",
            "51.140.0.0/14",
            "52.96.0.0/12",
            "52.112.0.0/14",
            "52.120.0.0/14",
            "52.136.0.0/13",
            "52.146.0.0/15",
            "52.148.0.0/14",
            "52.152.0.0/13",
            "52.160.0.0/11",
            "52.224.0.0/11",
            "65.52.0.0/14",
            "70.37.0.0/17",
            "104.40.0.0/13",
            "104.208.0.0/13",
            "137.116.0.0/14",
            "137.135.0.0/16",
            "168.61.0.0/16",
            "168.62.0.0/15",
            "191.232.0.0/13",
        ],
        "rdns_patterns": [
            r"\.azure\.com$",
            r"\.cloudapp\.net$",
            r"\.windows\.net$",
            r"\.microsoft\.com$",
        ],
    },
    "DigitalOcean": {
        "ip_ranges": [
            "45.55.0.0/16",
            "46.101.0.0/16",
            "67.205.128.0/17",
            "68.183.0.0/16",
            "104.131.0.0/16",
            "104.236.0.0/16",
            "128.199.0.0/16",
            "134.122.0.0/15",
            "137.184.0.0/14",
            "138.68.0.0/15",
            "138.197.0.0/16",
            "139.59.0.0/16",
            "142.93.0.0/16",
            "143.110.0.0/15",
            "143.198.0.0/15",
            "146.190.0.0/15",
            "157.230.0.0/15",
            "159.65.0.0/16",
            "159.89.0.0/16",
            "159.203.0.0/16",
            "161.35.0.0/16",
            "162.243.0.0/16",
            "164.90.0.0/15",
            "164.92.0.0/15",
            "165.22.0.0/15",
            "165.227.0.0/16",
            "167.71.0.0/16",
            "167.99.0.0/16",
            "178.62.0.0/16",
            "178.128.0.0/16",
            "188.166.0.0/15",
            "192.241.128.0/17",
            "198.199.64.0/18",
            "206.189.0.0/16",
            "209.97.128.0/17",
        ],
        "rdns_patterns": [
            r"\.digitalocean\.com$",
        ],
    },
    "Cloudflare": {
        "ip_ranges": [
            "103.21.244.0/22",
            "103.22.200.0/22",
            "103.31.4.0/22",
            "104.16.0.0/13",
            "104.24.0.0/14",
            "108.162.192.0/18",
            "131.0.72.0/22",
            "141.101.64.0/18",
            "162.158.0.0/15",
            "172.64.0.0/13",
            "173.245.48.0/20",
            "188.114.96.0/20",
            "190.93.240.0/20",
            "197.234.240.0/22",
            "198.41.128.0/17",
        ],
        "rdns_patterns": [
            r"\.cloudflare\.com$",
            r"\.cloudflare\.net$",
        ],
    },
    "OVH": {
        "ip_ranges": [
            "5.39.0.0/17",
            "5.135.0.0/16",
            "5.196.0.0/15",
            "37.59.0.0/16",
            "37.187.0.0/16",
            "46.105.0.0/16",
            "51.38.0.0/15",
            "51.68.0.0/14",
            "51.75.0.0/16",
            "51.77.0.0/16",
            "51.79.0.0/16",
            "51.83.0.0/16",
            "51.89.0.0/16",
            "51.91.0.0/16",
            "51.161.0.0/16",
            "51.210.0.0/15",
            "54.36.0.0/14",
            "91.121.0.0/16",
            "92.222.0.0/16",
            "135.125.0.0/16",
            "137.74.0.0/16",
            "139.99.0.0/16",
            "141.94.0.0/15",
            "145.239.0.0/16",
            "149.202.0.0/16",
            "151.80.0.0/16",
            "158.69.0.0/16",
            "164.132.0.0/16",
            "167.114.0.0/16",
            "176.31.0.0/16",
            "178.32.0.0/15",
            "188.165.0.0/16",
            "192.95.0.0/16",
            "193.70.0.0/16",
            "198.27.64.0/18",
            "198.50.128.0/17",
            "213.186.32.0/19",
            "213.251.128.0/18",
        ],
        "rdns_patterns": [
            r"\.ovh\.",
            r"\.kimsufi\.",
            r"\.soyoustart\.",
        ],
    },
    "Hetzner": {
        "ip_ranges": [
            "5.9.0.0/16",
            "23.88.0.0/13",
            "46.4.0.0/16",
            "78.46.0.0/15",
            "85.10.192.0/18",
            "88.198.0.0/16",
            "88.99.0.0/16",
            "91.107.128.0/17",
            "94.130.0.0/16",
            "95.216.0.0/15",
            "116.202.0.0/15",
            "116.203.0.0/16",
            "128.140.0.0/16",
            "135.181.0.0/16",
            "136.243.0.0/16",
            "138.201.0.0/16",
            "142.132.128.0/17",
            "144.76.0.0/16",
            "148.251.0.0/16",
            "157.90.0.0/16",
            "159.69.0.0/16",
            "162.55.0.0/16",
            "167.233.0.0/16",
            "168.119.0.0/16",
            "176.9.0.0/16",
            "178.63.0.0/16",
            "188.40.0.0/16",
            "195.201.0.0/16",
            "213.133.96.0/19",
            "213.239.192.0/18",
        ],
        "rdns_patterns": [
            r"\.hetzner\.",
            r"\.your-server\.de$",
        ],
    },
    "Linode": {
        "ip_ranges": [
            "23.92.16.0/20",
            "23.239.0.0/18",
            "45.33.0.0/17",
            "45.56.64.0/18",
            "45.79.0.0/16",
            "50.116.0.0/18",
            "66.175.208.0/20",
            "66.228.32.0/19",
            "69.164.192.0/18",
            "72.14.176.0/20",
            "74.207.224.0/19",
            "96.126.96.0/19",
            "97.107.128.0/17",
            "104.200.16.0/20",
            "139.144.0.0/15",
            "139.162.0.0/16",
            "143.42.0.0/15",
            "170.187.128.0/17",
            "172.104.0.0/15",
            "172.232.0.0/14",
            "173.230.128.0/17",
            "173.255.192.0/18",
            "178.79.128.0/17",
            "192.155.80.0/20",
            "194.195.112.0/20",
            "198.58.96.0/19",
            "198.74.48.0/20",
            "207.192.64.0/18",
            "212.71.232.0/21",
        ],
        "rdns_patterns": [
            r"\.linode\.com$",
            r"\.linodeobjects\.com$",
        ],
    },
    "Vultr": {
        "ip_ranges": [
            "45.32.0.0/15",
            "45.63.0.0/17",
            "45.76.0.0/15",
            "64.156.0.0/15",
            "64.176.0.0/13",
            "66.42.0.0/16",
            "78.141.192.0/18",
            "95.179.128.0/17",
            "104.156.224.0/19",
            "104.207.128.0/17",
            "108.61.0.0/16",
            "136.244.64.0/18",
            "137.220.32.0/19",
            "139.180.128.0/17",
            "140.82.0.0/16",
            "144.202.0.0/16",
            "149.28.0.0/16",
            "149.248.0.0/16",
            "155.138.128.0/17",
            "158.247.192.0/18",
            "167.179.0.0/17",
            "192.248.128.0/17",
            "207.148.64.0/18",
            "209.222.0.0/17",
            "216.128.128.0/17",
            "217.69.0.0/18",
        ],
        "rdns_patterns": [
            r"\.vultr\.com$",
            r"\.vultrusercontent\.com$",
        ],
    },
    "Akamai": {
        "ip_ranges": [
            "2.16.0.0/13",
            "23.0.0.0/12",
            "23.32.0.0/11",
            "23.64.0.0/10",
            "23.192.0.0/11",
            "72.246.0.0/15",
            "92.122.0.0/15",
            "95.100.0.0/15",
            "96.6.0.0/15",
            "96.16.0.0/15",
            "104.64.0.0/10",
            "118.214.0.0/16",
            "173.222.0.0/15",
            "184.24.0.0/13",
            "184.50.0.0/15",
            "184.84.0.0/14",
        ],
        "rdns_patterns": [
            r"\.akamai\.com$",
            r"\.akamai\.net$",
            r"\.akamaiedge\.net$",
            r"\.akamaitechnologies\.com$",
        ],
    },
}

# ASN to Provider mapping
ASN_PROVIDERS: dict[str, str] = {
    "AS16509": "AWS",
    "AS14618": "AWS",
    "AS15169": "Google",
    "AS396982": "Google Cloud",
    "AS8075": "Microsoft Azure",
    "AS14061": "DigitalOcean",
    "AS13335": "Cloudflare",
    "AS16276": "OVH",
    "AS24940": "Hetzner",
    "AS63949": "Linode (Akamai)",
    "AS20473": "Vultr",
    "AS20940": "Akamai",
    "AS16625": "Akamai",
    "AS36351": "SoftLayer (IBM)",
    "AS19551": "Incapsula",
    "AS54113": "Fastly",
    "AS22822": "Limelight",
    "AS13414": "Twitter",
    "AS32934": "Facebook",
    "AS46489": "Twitch",
    "AS2906": "Netflix",
    "AS714": "Apple",
    "AS6185": "Apple",
}
